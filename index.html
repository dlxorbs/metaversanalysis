<!DOCTYPE html>
<html>
  <head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.5.0/socket.io.slim.js"></script>
    <script src="https://unpkg.com/networked-aframe@^0.11.0/dist/networked-aframe.min.js"></script>

    <script src="https://aframe.io/releases/1.4.1/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-physics-system@v4.2.2/dist/aframe-physics-system.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@fb96ab2/dist/aframe-extras.js"></script>
    <script src="https://recast-api.donmccurdy.com/aframe-inspector-plugin-recast.js"></script>
    <script
      src="https://code.jquery.com/jquery-3.6.1.min.js"
      integrity="sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ="
      crossorigin="anonymous"
    ></script>
    <script src="./component.js"></script>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <a-scene id="first">
      <!-- 애니메이션 그룹 -->
      <div class="miniMap">
        <div class="oneppule"></div>
        <div class="cha"></div>
      </div>

      <div class="btnUI">
        <button class="start">측정시작</button>
        <button class="end">측정끝</button>
      </div>

      <div class="sysUI">
        <div class="container file_select">
          <input type="file" id="input_file" />
          <button onclick="read(event)">가져오기</button>
        </div>

        <div class="container camera_select">
          <div class="camera_select_title">카메라 선택</div>
          <div class="camera_button">
            <button class="change change1" onclick="change1()">TOP VIEW</button>
            <button class="change change2" onclick="change2()">
              NORMAL VIEW
            </button>
          </div>
        </div>
      </div>

      <!-- 캐릭터, 맵, 네비게이션 메쉬 모델링 -->
      <a-asset>
        <a-asset-item id="sbob" src="./glb/human.glb"></a-asset-item>
        <a-asset-item id="sbob2" src="./glb/human2.glb"></a-asset-item>
        <a-asset-item id="map" src="/glb/test_ground.glb"></a-asset-item>
        <a-asset-item id="nav-mesh" src="/glb/test_nav_mesh.glb"></a-asset-item>
      </a-asset>

      <!-- 로고 -->
      <a-asset>
        <a-asset-item id="logo" src="/glb/logo.glb"></a-asset-item>
        <img id="my-image" src="./image.png" />
        <img id="my-image2" src="./image2.png" />
        <img id="my-image3" src="./image3.jpg" />
        <img id="my-image4" src="./image4.jfif" />
        <img id="my-image5" src="./image5.jfif" />
      </a-asset>

      <a-sky color="#99ccff" radius="400"></a-sky>
      <a-entity
        class="navmesh"
        nav-mesh
        gltf-model="#nav-mesh"
        scale="1.4 1.4 1.4"
        position="0 0 0"
        visible="false"
      ></a-entity>
      <a-entity
        class="map"
        gltf-model="#map"
        scale="1.4 1.4 1.4"
        position="0 0 0"
        visible="true"
        rotation="0 0 0"
      ></a-entity>

      <!-- 캐릭터 그룹 -->
      <a-entity
        id="rig"
        raycaster-detected
        navmesh-constraint="navmesh:.navmesh; fall: 3; height: 0;"
        nav-agent
        movement-controls="constrainToNavMesh: true; speed:0.16"
        wasd-controls="acceleration:10, fly:true;"
        look-controls
        rotation-reader
      >
        <!-- 오리 모델링 -->
        <a-entity
          id="ssbob"
          gltf-model="#sbob"
          animation-mixer="clip: default;"
          position="0 0 0"
          rotation="0 0 0"
          scale="0.4 0.4 0.4"
          raycaster="lineColor:red; direction: 0 0 1; far:10; showLine:true;"
        ></a-entity>

        <!-- 카메라 -->
        <a-entity camera id="camera" rotation="0 0 0" position="0 2 8">
          <!-- 카메라 내부에 커서를 추가 레이 캐스터의 속성중 클릭 가능한 class만 지정할 수 있도록 하여 커서가 클릭할 수 있도록 제작 -->
          <a-cursor
            geometry="primitive: ring; radiusInner: 0; radiusOuter: 0"
            cursor="rayOrigin: mouse;"
            raycaster=" objects : .clickable; far : 1000;"
          ></a-cursor>
          <!-- <a-cursor geometry="primitive: ring; radiusInner: 0; radiusOuter: 0" cursor="rayOrigin: mouse;" nav-pointer raycaster = "objects: [nav-mesh]" ></a-cursor> -->
        </a-entity>
      </a-entity>

      <!-- 두번째 카메라 -->
      <a-entity id="cameraRig" position="0 24 8">
        <a-entity id="second-camera" camera look-controls></a-entity>
      </a-entity>

      <!-- 이동경로 저장 -->
      <a-entity id="positionMap" position="0 0 0"></a-entity>

      <!-- 로고 -->
      <a-entity
        id="guide"
        class="detecter clickable guide"
        animation-mixer="clip: roll;"
        position="11 6 -22"
        rotation="0 90 0"
        scale="0.2 0.2 0.2"
        raycaster-detected
      >
        <a-entity id="logo3D" gltf-model="#logo"></a-entity>
        <a-image
          src="#my-image"
          rotation="0 -90 0"
          position="-1 -8 0"
          scale="24 6 6"
          opacity="0"
          id="image"
        ></a-image>
        <a-image
          src="#my-image2"
          rotation="0 -90 0"
          position="-12 -1 0"
          scale="40 24 18"
          opacity="0"
          id="image2"
        ></a-image>
      </a-entity>

      <!-- NPC -->
      <a-entity
        id="ssbob"
        gltf-model="#sbob2"
        animation-mixer="clip: default;"
        position="0 0 -18"
        rotation="0 30 0"
        scale="0.4 0.4 0.4"
      ></a-entity>
      <a-entity
        id="ssbob"
        gltf-model="#sbob2"
        animation-mixer="clip: default;"
        position="2 0 -17"
        rotation="0 -60 0"
        scale="0.4 0.4 0.4"
      ></a-entity>

      <!-- 이미지선택하는 -->
      <a-image
        src="#my-image3"
        rotation="-20 90 0"
        position="-11 1 -12"
        scale="3 2 2"
        opacity="0"
        id="image3"
      ></a-image>
      <a-box
        cursor-listener
        buttonback
        analysis-click
        rotation="20 -90 0"
        position="-11 1 -9.5"
        scale="0.8 0.8 0.8"
        opacity="0"
        class="clickable"
        id="btn1"
      ></a-box>
      <a-box
        cursor-listener
        buttonnext
        analysis-click
        rotation="20 -90 0"
        position="-11 1 -14.5"
        scale="0.8w 0.8 0.8"
        opacity="0"
        class="clickable"
        id="btn2"
      ></a-box>

      <a-box
        id="box"
        hello-world
        position="-12 0 -12"
        raycaster-detected
        opacity="0"
      ></a-box>
    </a-scene>
  </body>

  <script src="style.js"></script>
</html>
